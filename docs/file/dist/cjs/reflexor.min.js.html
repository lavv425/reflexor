<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../">
  <title data-ice="title">dist/cjs/reflexor.min.js | API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <a data-ice="repoURL" href="https://github.com/lavv425/reflexor" class="repo-url-github">Repository</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-reflex">reflex</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">constants</div><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-STORAGE_KEY">STORAGE_KEY</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">utils</div><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-md5">md5</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">dist/cjs/reflexor.min.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">&quot;use strict&quot;;var e;class t{static async openIndexedDB(e=&quot;ReflexorDB&quot;,t=&quot;reflexStates&quot;){return new Promise(((s,r)=&gt;{const i=indexedDB.open(e,1);i.onupgradeneeded=e=&gt;{const s=e.target.result;s.objectStoreNames.contains(t)||s.createObjectStore(t,{keyPath:&quot;key&quot;})},i.onsuccess=e=&gt;s(e.target.result),i.onerror=e=&gt;r(e.target.error)}))}static async saveToIndexedDB(e,t,s=&quot;reflexStates&quot;){return this.enqueueTransaction((async()=&gt;{const r=await this.openIndexedDB();return new Promise(((i,a)=&gt;{const n=r.transaction(s,&quot;readwrite&quot;).objectStore(s).put({key:e,value:t});n.onsuccess=()=&gt;i(),n.onerror=e=&gt;a(e.target.error)}))}))}static async getFromIndexedDB(e,t=&quot;reflexStates&quot;){const s=await this.openIndexedDB();return new Promise(((r,i)=&gt;{const a=s.transaction(t,&quot;readonly&quot;).objectStore(t).get(e);a.onsuccess=e=&gt;{var t;return r((null===(t=e.target.result)||void 0===t?void 0:t.value)||null)},a.onerror=e=&gt;i(e.target.error)}))}static ensureFileExists(){var e;this.isNode&amp;&amp;!(null===(e=this.fs)||void 0===e?void 0:e.existsSync(this.FILE_PATH))&amp;&amp;this.fs.writeFileSync(this.FILE_PATH,JSON.stringify({}))}static saveToFile(e,t){if(!this.isNode)return;this.ensureFileExists();const s=JSON.parse(this.fs.readFileSync(this.FILE_PATH,&quot;utf-8&quot;));s[e]=t,this.fs.writeFileSync(this.FILE_PATH,JSON.stringify(s,null,2))}static getFromFile(e){if(!this.isNode)return null;this.ensureFileExists();return JSON.parse(this.fs.readFileSync(this.FILE_PATH,&quot;utf-8&quot;))[e]||null}static async saveState(e,t){this.isNode?this.saveToFile(e,t):await this.saveToIndexedDB(e,t)}static async getState(e){return this.isNode?this.getFromFile(e):await this.getFromIndexedDB(e)}static async initialize(){if(this.initialized)return;const e=[];return this.reflexStates.forEach((t=&gt;{t.persisted&amp;&amp;t.key&amp;&amp;e.push(this.getState(t.key).then((e=&gt;{null!==e&amp;&amp;(t.value=e)})))})),this.initializationPromise=Promise.all(e).then((()=&gt;{this.initialized=!0})),this.initializationPromise}static enableBatching(){this.batchingEnabled=!0}static disableBatching(){this.batchingEnabled=!1}static flushBatches(){this.batchingEnabled=!1,this.batchedUpdates.forEach(((e,t)=&gt;{const s=this.reflexStates.get(t);s&amp;&amp;(s.value=e,s.listeners.forEach((t=&gt;t(e))))})),this.batchedUpdates.clear()}static setValueWithBatching(e,t){this.batchingEnabled?this.batchedUpdates.set(e.key,t):(e.value=t,e.listeners.forEach((e=&gt;e(t))))}static enqueueTransaction(e){return this.transactionQueue=this.transactionQueue.then(e),this.transactionQueue}static setLogger(e){this.logger=e}static log(e,...t){this.logger&amp;&amp;&quot;function&quot;==typeof this.logger[e]&amp;&amp;this.logger[e](...t)}static reflex(e,t){const s=Boolean(t&amp;&amp;t.length&gt;0),r=s?(e=&gt;{function t(e,t){return e&lt;&lt;t|e&gt;&gt;&gt;32-t}function s(e,t){const s=1073741824&amp;e,r=1073741824&amp;t,i=2147483648&amp;e,a=2147483648&amp;t,n=(1073741823&amp;e)+(1073741823&amp;t);return s&amp;r?2147483648^n^i^a:s|r?1073741824&amp;n?3221225472^n^i^a:1073741824^n^i^a:n^i^a}function r(e,r,i,a,n,l,o){return e=s(e,s(s(function(e,t,s){return e&amp;t|~e&amp;s}(r,i,a),n),o)),s(t(e,l),r)}function i(e,r,i,a,n,l,o){return e=s(e,s(s(function(e,t,s){return e&amp;s|t&amp;~s}(r,i,a),n),o)),s(t(e,l),r)}function a(e,r,i,a,n,l,o){return e=s(e,s(s(function(e,t,s){return e^t^s}(r,i,a),n),o)),s(t(e,l),r)}function n(e,r,i,a,n,l,o){return e=s(e,s(s(function(e,t,s){return t^(e|~s)}(r,i,a),n),o)),s(t(e,l),r)}function l(e){let t=&quot;&quot;;for(let s=0;s&lt;=3;s++)t+=(&quot;0&quot;+(e&gt;&gt;&gt;8*s&amp;255).toString(16)).slice(-2);return t}let o,c,h,u,d,f,x,g,p,S=[];for(e=function(e){e=e.replace(/\r\n/g,&quot;\n&quot;);let t=&quot;&quot;;for(let s=0;s&lt;e.length;s++){const r=e.charCodeAt(s);r&lt;128?t+=String.fromCharCode(r):r&gt;127&amp;&amp;r&lt;2048?(t+=String.fromCharCode(r&gt;&gt;6|192),t+=String.fromCharCode(63&amp;r|128)):(t+=String.fromCharCode(r&gt;&gt;12|224),t+=String.fromCharCode(r&gt;&gt;6&amp;63|128),t+=String.fromCharCode(63&amp;r|128))}return t}(e),S=function(e){const t=e.length,s=t+8,r=16*((s-s%64)/64+1),i=new Array(r-1);let a=0,n=0;for(;n&lt;t;){const t=(n-n%4)/4;a=n%4*8,i[t]=i[t]|e.charCodeAt(n)&lt;&lt;a,n++}const l=(n-n%4)/4;return a=n%4*8,i[l]=i[l]|128&lt;&lt;a,i[r-2]=t&lt;&lt;3,i[r-1]=t&gt;&gt;&gt;29,i}(e),f=1732584193,x=4023233417,g=2562383102,p=271733878,o=0;o&lt;S.length;o+=16)c=f,h=x,u=g,d=p,f=r(f,x,g,p,S[o+0],7,3614090360),p=r(p,f,x,g,S[o+1],12,3905402710),g=r(g,p,f,x,S[o+2],17,606105819),x=r(x,g,p,f,S[o+3],22,3250441966),f=r(f,x,g,p,S[o+4],7,4118548399),p=r(p,f,x,g,S[o+5],12,1200080426),g=r(g,p,f,x,S[o+6],17,2821735955),x=r(x,g,p,f,S[o+7],22,4249261313),f=r(f,x,g,p,S[o+8],7,1770035416),p=r(p,f,x,g,S[o+9],12,2336552879),g=r(g,p,f,x,S[o+10],17,4294925233),x=r(x,g,p,f,S[o+11],22,2304563134),f=r(f,x,g,p,S[o+12],7,1804603682),p=r(p,f,x,g,S[o+13],12,4254626195),g=r(g,p,f,x,S[o+14],17,2792965006),x=r(x,g,p,f,S[o+15],22,1236535329),f=i(f,x,g,p,S[o+1],5,4129170786),p=i(p,f,x,g,S[o+6],9,3225465664),g=i(g,p,f,x,S[o+11],14,643717713),x=i(x,g,p,f,S[o+0],20,3921069994),f=i(f,x,g,p,S[o+5],5,3593408605),p=i(p,f,x,g,S[o+10],9,38016083),g=i(g,p,f,x,S[o+15],14,3634488961),x=i(x,g,p,f,S[o+4],20,3889429448),f=i(f,x,g,p,S[o+9],5,568446438),p=i(p,f,x,g,S[o+14],9,3275163606),g=i(g,p,f,x,S[o+3],14,4107603335),x=i(x,g,p,f,S[o+8],20,1163531501),f=i(f,x,g,p,S[o+13],5,2850285829),p=i(p,f,x,g,S[o+2],9,4243563512),g=i(g,p,f,x,S[o+7],14,1735328473),x=i(x,g,p,f,S[o+12],20,2368359562),f=a(f,x,g,p,S[o+5],4,4294588738),p=a(p,f,x,g,S[o+8],11,2272392833),g=a(g,p,f,x,S[o+11],16,1839030562),x=a(x,g,p,f,S[o+14],23,4259657740),f=a(f,x,g,p,S[o+1],4,2763975236),p=a(p,f,x,g,S[o+4],11,1272893353),g=a(g,p,f,x,S[o+7],16,4139469664),x=a(x,g,p,f,S[o+10],23,3200236656),f=a(f,x,g,p,S[o+13],4,681279174),p=a(p,f,x,g,S[o+0],11,3936430074),g=a(g,p,f,x,S[o+3],16,3572445317),x=a(x,g,p,f,S[o+6],23,76029189),f=a(f,x,g,p,S[o+9],4,3654602809),p=a(p,f,x,g,S[o+12],11,3873151461),g=a(g,p,f,x,S[o+15],16,530742520),x=a(x,g,p,f,S[o+2],23,3299628645),f=n(f,x,g,p,S[o+0],6,4096336452),p=n(p,f,x,g,S[o+7],10,1126891415),g=n(g,p,f,x,S[o+14],15,2878612391),x=n(x,g,p,f,S[o+5],21,4237533241),f=n(f,x,g,p,S[o+12],6,1700485571),p=n(p,f,x,g,S[o+3],10,2399980690),g=n(g,p,f,x,S[o+10],15,4293915773),x=n(x,g,p,f,S[o+1],21,2240044497),f=n(f,x,g,p,S[o+8],6,1873313359),p=n(p,f,x,g,S[o+15],10,4264355552),g=n(g,p,f,x,S[o+6],15,2734768916),x=n(x,g,p,f,S[o+13],21,1309151649),f=n(f,x,g,p,S[o+4],6,4149444226),p=n(p,f,x,g,S[o+11],10,3174756917),g=n(g,p,f,x,S[o+2],15,718787259),x=n(x,g,p,f,S[o+9],21,3951481745),f=s(f,c),x=s(x,h),g=s(g,u),p=s(p,d);return(l(f)+l(x)+l(g)+l(p)).toLowerCase()})(`reflex-${t}`):void 0;let i=e;r&amp;&amp;this.getState(r).then((e=&gt;{null!==e&amp;&amp;(a.value=e,a.listeners.forEach((t=&gt;t(e))))})).catch((e=&gt;{console.error(&quot;Error retrieving persisted value:&quot;,e)}));const a={value:i,initialValue:e,listeners:[],dropListeners:[],resetListeners:[],persisted:s,key:r},n=async()=&gt;{a.persisted&amp;&amp;a.key&amp;&amp;await this.saveState(a.key,a.value)},l=new Proxy(a,{set:(e,t,s)=&gt;&quot;value&quot;===t&amp;&amp;(e.value=s,e.listeners.forEach((e=&gt;e(s))),n(),!0),deleteProperty:(e,t)=&gt;&quot;value&quot;===t&amp;&amp;(e.dropListeners.forEach((t=&gt;t(e.value))),delete e.value,a.persisted&amp;&amp;a.key&amp;&amp;this.saveState(a.key,null),!0)});return this.reflexStates.set(l,a),l}static getReflexValue(e){const t=this.reflexStates.get(e);return t?t.value:void 0}static hasReflex(e){return this.reflexStates.has(e)}static removeReflex(e){const t=this.reflexStates.get(e);t&amp;&amp;t.key&amp;&amp;this.saveState(t.key,null),this.reflexStates.delete(e)}static getAllReflexes(){return this.reflexStates}static clearAllReflexes(){this.reflexStates.forEach(((e,t)=&gt;{e.persisted&amp;&amp;e.key&amp;&amp;this.saveState(e.key,null)})),this.reflexStates.clear()}static getStateCount(){return this.reflexStates.size}static addMiddleware(e){this.middlewares.push(e)}static applyMiddlewares(e,t){return this.middlewares.reduce(((t,s)=&gt;s(e,t)),t)}static setValueWithMiddleware(e,t){const s=this.applyMiddlewares(e,t);e.value=s,e.listeners.forEach((e=&gt;e(s)))}static onReflexChange(e,t){t.forEach((t=&gt;{const s=this.reflexStates.get(t);s&amp;&amp;s.listeners.push(e)}))}static onReflexDrop(e,t){t.forEach((t=&gt;{const s=this.reflexStates.get(t);s&amp;&amp;s.dropListeners.push(e)}))}static onReflexReset(e,t){t.forEach((t=&gt;{const s=this.reflexStates.get(t);s&amp;&amp;s.resetListeners.push(e)}))}static reset(e){const t=this.reflexStates.get(e);t&amp;&amp;(t.value=t.initialValue,t.persisted&amp;&amp;t.key&amp;&amp;this.saveState(t.key,t.initialValue),t.listeners.forEach((e=&gt;e(t.initialValue))),t.resetListeners.forEach((e=&gt;e(t.initialValue))))}}e=t,t.reflexStates=new Map,t.isNode=&quot;undefined&quot;==typeof window,t.initialized=!1,t.initializationPromise=null,t.batchingEnabled=!1,t.batchedUpdates=new Map,t.transactionQueue=Promise.resolve(),t.logger=console,t.middlewares=[],t.fs=e.isNode?require(&quot;fs&quot;):null,t.path=e.isNode?require(&quot;path&quot;):null,t.FILE_PATH=e.isNode?e.path.resolve(__dirname,&quot;reflexor_store.json&quot;):null;const{reflex:s,onReflexChange:r,onReflexDrop:i,onReflexReset:a,reset:n,initialize:l,enableBatching:o,flushBatches:c,removeReflex:h,getReflexValue:u,hasReflex:d,getAllReflexes:f,clearAllReflexes:x,addMiddleware:g,disableBatching:p,getStateCount:S,setLogger:v}=t;exports.addMiddleware=g,exports.clearAllReflexes=x,exports.disableBatching=p,exports.enableBatching=o,exports.flushBatches=c,exports.getAllReflexes=f,exports.getReflexValue=u,exports.getStateCount=S,exports.hasReflex=d,exports.initialize=l,exports.onReflexChange=r,exports.onReflexDrop=i,exports.onReflexReset=a,exports.reflex=s,exports.removeReflex=h,exports.reset=n,exports.setLogger=v;
//# sourceMappingURL=reflexor.min.js.map
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.4.8)</span></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
