<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../">
  <title data-ice="title">dist/es/reflexor.min.js | API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <a data-ice="repoURL" href="https://github.com/lavv425/reflexor" class="repo-url-github">Repository</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-reflex">reflex</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">constants</div><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-STORAGE_KEY">STORAGE_KEY</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">utils</div><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-md5">md5</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">dist/es/reflexor.min.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">var e;class t{static async openIndexedDB(e=&quot;ReflexorDB&quot;,t=&quot;reflexStates&quot;){return new Promise(((s,i)=&gt;{const r=indexedDB.open(e,1);r.onupgradeneeded=e=&gt;{const s=e.target.result;s.objectStoreNames.contains(t)||s.createObjectStore(t,{keyPath:&quot;key&quot;})},r.onsuccess=e=&gt;s(e.target.result),r.onerror=e=&gt;i(e.target.error)}))}static async saveToIndexedDB(e,t,s=&quot;reflexStates&quot;){return this.enqueueTransaction((async()=&gt;{const i=await this.openIndexedDB();return new Promise(((r,a)=&gt;{const n=i.transaction(s,&quot;readwrite&quot;).objectStore(s).put({key:e,value:t});n.onsuccess=()=&gt;r(),n.onerror=e=&gt;a(e.target.error)}))}))}static async getFromIndexedDB(e,t=&quot;reflexStates&quot;){const s=await this.openIndexedDB();return new Promise(((i,r)=&gt;{const a=s.transaction(t,&quot;readonly&quot;).objectStore(t).get(e);a.onsuccess=e=&gt;{var t;return i((null===(t=e.target.result)||void 0===t?void 0:t.value)||null)},a.onerror=e=&gt;r(e.target.error)}))}static ensureFileExists(){var e;this.isNode&amp;&amp;!(null===(e=this.fs)||void 0===e?void 0:e.existsSync(this.FILE_PATH))&amp;&amp;this.fs.writeFileSync(this.FILE_PATH,JSON.stringify({}))}static saveToFile(e,t){if(!this.isNode)return;this.ensureFileExists();const s=JSON.parse(this.fs.readFileSync(this.FILE_PATH,&quot;utf-8&quot;));s[e]=t,this.fs.writeFileSync(this.FILE_PATH,JSON.stringify(s,null,2))}static getFromFile(e){if(!this.isNode)return null;this.ensureFileExists();return JSON.parse(this.fs.readFileSync(this.FILE_PATH,&quot;utf-8&quot;))[e]||null}static async saveState(e,t){this.isNode?this.saveToFile(e,t):await this.saveToIndexedDB(e,t)}static async getState(e){return this.isNode?this.getFromFile(e):await this.getFromIndexedDB(e)}static async initialize(){if(this.initialized)return;const e=[];return this.reflexStates.forEach((t=&gt;{t.persisted&amp;&amp;t.key&amp;&amp;e.push(this.getState(t.key).then((e=&gt;{null!==e&amp;&amp;(t.value=e)})))})),this.initializationPromise=Promise.all(e).then((()=&gt;{this.initialized=!0})),this.initializationPromise}static enableBatching(){this.batchingEnabled=!0}static disableBatching(){this.batchingEnabled=!1}static flushBatches(){this.batchingEnabled=!1,this.batchedUpdates.forEach(((e,t)=&gt;{const s=this.reflexStates.get(t);s&amp;&amp;(s.value=e,s.listeners.forEach((t=&gt;t(e))))})),this.batchedUpdates.clear()}static setValueWithBatching(e,t){this.batchingEnabled?this.batchedUpdates.set(e.key,t):(e.value=t,e.listeners.forEach((e=&gt;e(t))))}static enqueueTransaction(e){return this.transactionQueue=this.transactionQueue.then(e),this.transactionQueue}static setLogger(e){this.logger=e}static log(e,...t){this.logger&amp;&amp;&quot;function&quot;==typeof this.logger[e]&amp;&amp;this.logger[e](...t)}static reflex(e,t){const s=Boolean(t&amp;&amp;t.length&gt;0),i=s?(e=&gt;{function t(e,t){return e&lt;&lt;t|e&gt;&gt;&gt;32-t}function s(e,t){const s=1073741824&amp;e,i=1073741824&amp;t,r=2147483648&amp;e,a=2147483648&amp;t,n=(1073741823&amp;e)+(1073741823&amp;t);return s&amp;i?2147483648^n^r^a:s|i?1073741824&amp;n?3221225472^n^r^a:1073741824^n^r^a:n^r^a}function i(e,i,r,a,n,l,o){return e=s(e,s(s(function(e,t,s){return e&amp;t|~e&amp;s}(i,r,a),n),o)),s(t(e,l),i)}function r(e,i,r,a,n,l,o){return e=s(e,s(s(function(e,t,s){return e&amp;s|t&amp;~s}(i,r,a),n),o)),s(t(e,l),i)}function a(e,i,r,a,n,l,o){return e=s(e,s(s(function(e,t,s){return e^t^s}(i,r,a),n),o)),s(t(e,l),i)}function n(e,i,r,a,n,l,o){return e=s(e,s(s(function(e,t,s){return t^(e|~s)}(i,r,a),n),o)),s(t(e,l),i)}function l(e){let t=&quot;&quot;;for(let s=0;s&lt;=3;s++)t+=(&quot;0&quot;+(e&gt;&gt;&gt;8*s&amp;255).toString(16)).slice(-2);return t}let o,c,h,u,d,f,g,x,S,p=[];for(e=function(e){e=e.replace(/\r\n/g,&quot;\n&quot;);let t=&quot;&quot;;for(let s=0;s&lt;e.length;s++){const i=e.charCodeAt(s);i&lt;128?t+=String.fromCharCode(i):i&gt;127&amp;&amp;i&lt;2048?(t+=String.fromCharCode(i&gt;&gt;6|192),t+=String.fromCharCode(63&amp;i|128)):(t+=String.fromCharCode(i&gt;&gt;12|224),t+=String.fromCharCode(i&gt;&gt;6&amp;63|128),t+=String.fromCharCode(63&amp;i|128))}return t}(e),p=function(e){const t=e.length,s=t+8,i=16*((s-s%64)/64+1),r=new Array(i-1);let a=0,n=0;for(;n&lt;t;){const t=(n-n%4)/4;a=n%4*8,r[t]=r[t]|e.charCodeAt(n)&lt;&lt;a,n++}const l=(n-n%4)/4;return a=n%4*8,r[l]=r[l]|128&lt;&lt;a,r[i-2]=t&lt;&lt;3,r[i-1]=t&gt;&gt;&gt;29,r}(e),f=1732584193,g=4023233417,x=2562383102,S=271733878,o=0;o&lt;p.length;o+=16)c=f,h=g,u=x,d=S,f=i(f,g,x,S,p[o+0],7,3614090360),S=i(S,f,g,x,p[o+1],12,3905402710),x=i(x,S,f,g,p[o+2],17,606105819),g=i(g,x,S,f,p[o+3],22,3250441966),f=i(f,g,x,S,p[o+4],7,4118548399),S=i(S,f,g,x,p[o+5],12,1200080426),x=i(x,S,f,g,p[o+6],17,2821735955),g=i(g,x,S,f,p[o+7],22,4249261313),f=i(f,g,x,S,p[o+8],7,1770035416),S=i(S,f,g,x,p[o+9],12,2336552879),x=i(x,S,f,g,p[o+10],17,4294925233),g=i(g,x,S,f,p[o+11],22,2304563134),f=i(f,g,x,S,p[o+12],7,1804603682),S=i(S,f,g,x,p[o+13],12,4254626195),x=i(x,S,f,g,p[o+14],17,2792965006),g=i(g,x,S,f,p[o+15],22,1236535329),f=r(f,g,x,S,p[o+1],5,4129170786),S=r(S,f,g,x,p[o+6],9,3225465664),x=r(x,S,f,g,p[o+11],14,643717713),g=r(g,x,S,f,p[o+0],20,3921069994),f=r(f,g,x,S,p[o+5],5,3593408605),S=r(S,f,g,x,p[o+10],9,38016083),x=r(x,S,f,g,p[o+15],14,3634488961),g=r(g,x,S,f,p[o+4],20,3889429448),f=r(f,g,x,S,p[o+9],5,568446438),S=r(S,f,g,x,p[o+14],9,3275163606),x=r(x,S,f,g,p[o+3],14,4107603335),g=r(g,x,S,f,p[o+8],20,1163531501),f=r(f,g,x,S,p[o+13],5,2850285829),S=r(S,f,g,x,p[o+2],9,4243563512),x=r(x,S,f,g,p[o+7],14,1735328473),g=r(g,x,S,f,p[o+12],20,2368359562),f=a(f,g,x,S,p[o+5],4,4294588738),S=a(S,f,g,x,p[o+8],11,2272392833),x=a(x,S,f,g,p[o+11],16,1839030562),g=a(g,x,S,f,p[o+14],23,4259657740),f=a(f,g,x,S,p[o+1],4,2763975236),S=a(S,f,g,x,p[o+4],11,1272893353),x=a(x,S,f,g,p[o+7],16,4139469664),g=a(g,x,S,f,p[o+10],23,3200236656),f=a(f,g,x,S,p[o+13],4,681279174),S=a(S,f,g,x,p[o+0],11,3936430074),x=a(x,S,f,g,p[o+3],16,3572445317),g=a(g,x,S,f,p[o+6],23,76029189),f=a(f,g,x,S,p[o+9],4,3654602809),S=a(S,f,g,x,p[o+12],11,3873151461),x=a(x,S,f,g,p[o+15],16,530742520),g=a(g,x,S,f,p[o+2],23,3299628645),f=n(f,g,x,S,p[o+0],6,4096336452),S=n(S,f,g,x,p[o+7],10,1126891415),x=n(x,S,f,g,p[o+14],15,2878612391),g=n(g,x,S,f,p[o+5],21,4237533241),f=n(f,g,x,S,p[o+12],6,1700485571),S=n(S,f,g,x,p[o+3],10,2399980690),x=n(x,S,f,g,p[o+10],15,4293915773),g=n(g,x,S,f,p[o+1],21,2240044497),f=n(f,g,x,S,p[o+8],6,1873313359),S=n(S,f,g,x,p[o+15],10,4264355552),x=n(x,S,f,g,p[o+6],15,2734768916),g=n(g,x,S,f,p[o+13],21,1309151649),f=n(f,g,x,S,p[o+4],6,4149444226),S=n(S,f,g,x,p[o+11],10,3174756917),x=n(x,S,f,g,p[o+2],15,718787259),g=n(g,x,S,f,p[o+9],21,3951481745),f=s(f,c),g=s(g,h),x=s(x,u),S=s(S,d);return(l(f)+l(g)+l(x)+l(S)).toLowerCase()})(`reflex-${t}`):void 0;let r=e;i&amp;&amp;this.getState(i).then((e=&gt;{null!==e&amp;&amp;(a.value=e,a.listeners.forEach((t=&gt;t(e))))})).catch((e=&gt;{console.error(&quot;Error retrieving persisted value:&quot;,e)}));const a={value:r,initialValue:e,listeners:[],dropListeners:[],resetListeners:[],persisted:s,key:i},n=async()=&gt;{a.persisted&amp;&amp;a.key&amp;&amp;await this.saveState(a.key,a.value)},l=new Proxy(a,{set:(e,t,s)=&gt;&quot;value&quot;===t&amp;&amp;(e.value=s,e.listeners.forEach((e=&gt;e(s))),n(),!0),deleteProperty:(e,t)=&gt;&quot;value&quot;===t&amp;&amp;(e.dropListeners.forEach((t=&gt;t(e.value))),delete e.value,a.persisted&amp;&amp;a.key&amp;&amp;this.saveState(a.key,null),!0)});return this.reflexStates.set(l,a),l}static getReflexValue(e){const t=this.reflexStates.get(e);return t?t.value:void 0}static hasReflex(e){return this.reflexStates.has(e)}static removeReflex(e){const t=this.reflexStates.get(e);t&amp;&amp;t.key&amp;&amp;this.saveState(t.key,null),this.reflexStates.delete(e)}static getAllReflexes(){return this.reflexStates}static clearAllReflexes(){this.reflexStates.forEach(((e,t)=&gt;{e.persisted&amp;&amp;e.key&amp;&amp;this.saveState(e.key,null)})),this.reflexStates.clear()}static getStateCount(){return this.reflexStates.size}static addMiddleware(e){this.middlewares.push(e)}static applyMiddlewares(e,t){return this.middlewares.reduce(((t,s)=&gt;s(e,t)),t)}static setValueWithMiddleware(e,t){const s=this.applyMiddlewares(e,t);e.value=s,e.listeners.forEach((e=&gt;e(s)))}static onReflexChange(e,t){t.forEach((t=&gt;{const s=this.reflexStates.get(t);s&amp;&amp;s.listeners.push(e)}))}static onReflexDrop(e,t){t.forEach((t=&gt;{const s=this.reflexStates.get(t);s&amp;&amp;s.dropListeners.push(e)}))}static onReflexReset(e,t){t.forEach((t=&gt;{const s=this.reflexStates.get(t);s&amp;&amp;s.resetListeners.push(e)}))}static reset(e){const t=this.reflexStates.get(e);t&amp;&amp;(t.value=t.initialValue,t.persisted&amp;&amp;t.key&amp;&amp;this.saveState(t.key,t.initialValue),t.listeners.forEach((e=&gt;e(t.initialValue))),t.resetListeners.forEach((e=&gt;e(t.initialValue))))}}e=t,t.reflexStates=new Map,t.isNode=&quot;undefined&quot;==typeof window,t.initialized=!1,t.initializationPromise=null,t.batchingEnabled=!1,t.batchedUpdates=new Map,t.transactionQueue=Promise.resolve(),t.logger=console,t.middlewares=[],t.fs=e.isNode?require(&quot;fs&quot;):null,t.path=e.isNode?require(&quot;path&quot;):null,t.FILE_PATH=e.isNode?e.path.resolve(__dirname,&quot;reflexor_store.json&quot;):null;const{reflex:s,onReflexChange:i,onReflexDrop:r,onReflexReset:a,reset:n,initialize:l,enableBatching:o,flushBatches:c,removeReflex:h,getReflexValue:u,hasReflex:d,getAllReflexes:f,clearAllReflexes:g,addMiddleware:x,disableBatching:S,getStateCount:p,setLogger:v}=t;export{x as addMiddleware,g as clearAllReflexes,S as disableBatching,o as enableBatching,c as flushBatches,f as getAllReflexes,u as getReflexValue,p as getStateCount,d as hasReflex,l as initialize,i as onReflexChange,r as onReflexDrop,a as onReflexReset,s as reflex,h as removeReflex,n as reset,v as setLogger};
//# sourceMappingURL=reflexor.min.js.map
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.4.8)</span></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
