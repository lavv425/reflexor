!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";var e;"undefined"!=typeof window?window:globalThis,e=function(){const e=new Map,r="undefined"==typeof window,t=async(e="ReflexorDB",r="reflexStates")=>new Promise(((t,n)=>{const o=indexedDB.open(e,1);o.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains(r)||t.createObjectStore(r,{keyPath:"key"})},o.onsuccess=e=>t(e.target.result),o.onerror=e=>n(e.target.error)})),n=r?require("fs"):null,o=r?require("path"):null,s=r?o.resolve(__dirname,"reflexor_store.json"):null,i=()=>{r&&!n.existsSync(s)&&n.writeFileSync(s,JSON.stringify({}))},a=async(e,o)=>{r?((e,t)=>{if(!r)return;i();const o=JSON.parse(n.readFileSync(s,"utf-8"));o[e]=t,n.writeFileSync(s,JSON.stringify(o,null,2))})(e,o):await(async(e,r,n="reflexStates")=>{const o=await t();return new Promise(((t,s)=>{const i=o.transaction(n,"readwrite").objectStore(n).put({key:e,value:r});i.onsuccess=()=>t(),i.onerror=e=>s(e.target.error)}))})(e,o)},l=async e=>r?(e=>r?(i(),JSON.parse(n.readFileSync(s,"utf-8"))[e]||null):null)(e):await(async(e,r="reflexStates")=>{const n=await t();return new Promise(((t,o)=>{const s=n.transaction(r,"readonly").objectStore(r).get(e);s.onsuccess=e=>{var r;return t((null===(r=e.target.result)||void 0===r?void 0:r.value)||null)},s.onerror=e=>o(e.target.error)}))})(e);return{reflex:(r,t)=>{const n=Boolean(t&&t.length>0),o=n?(e=>{function r(e,r){return e<<r|e>>>32-r}function t(e,r){const t=1073741824&e,n=1073741824&r,o=2147483648&e,s=2147483648&r,i=(1073741823&e)+(1073741823&r);return t&n?2147483648^i^o^s:t|n?1073741824&i?3221225472^i^o^s:1073741824^i^o^s:i^o^s}function n(e,n,o,s,i,a,l){return e=t(e,t(t(function(e,r,t){return e&r|~e&t}(n,o,s),i),l)),t(r(e,a),n)}function o(e,n,o,s,i,a,l){return e=t(e,t(t(function(e,r,t){return e&t|r&~t}(n,o,s),i),l)),t(r(e,a),n)}function s(e,n,o,s,i,a,l){return e=t(e,t(t(function(e,r,t){return e^r^t}(n,o,s),i),l)),t(r(e,a),n)}function i(e,n,o,s,i,a,l){return e=t(e,t(t(function(e,r,t){return r^(e|~t)}(n,o,s),i),l)),t(r(e,a),n)}function a(e){let r="";for(let t=0;t<=3;t++)r+=("0"+(e>>>8*t&255).toString(16)).slice(-2);return r}let l,u,c,f,d,y,g,h,p,S=[];for(e=function(e){e=e.replace(/\r\n/g,"\n");let r="";for(let t=0;t<e.length;t++){const n=e.charCodeAt(t);n<128?r+=String.fromCharCode(n):n>127&&n<2048?(r+=String.fromCharCode(n>>6|192),r+=String.fromCharCode(63&n|128)):(r+=String.fromCharCode(n>>12|224),r+=String.fromCharCode(n>>6&63|128),r+=String.fromCharCode(63&n|128))}return r}(e),S=function(e){const r=e.length,t=r+8,n=16*((t-t%64)/64+1),o=new Array(n-1);let s=0,i=0;for(;i<r;){const r=(i-i%4)/4;s=i%4*8,o[r]=o[r]|e.charCodeAt(i)<<s,i++}const a=(i-i%4)/4;return s=i%4*8,o[a]=o[a]|128<<s,o[n-2]=r<<3,o[n-1]=r>>>29,o}(e),y=1732584193,g=4023233417,h=2562383102,p=271733878,l=0;l<S.length;l+=16)u=y,c=g,f=h,d=p,y=n(y,g,h,p,S[l+0],7,3614090360),p=n(p,y,g,h,S[l+1],12,3905402710),h=n(h,p,y,g,S[l+2],17,606105819),g=n(g,h,p,y,S[l+3],22,3250441966),y=n(y,g,h,p,S[l+4],7,4118548399),p=n(p,y,g,h,S[l+5],12,1200080426),h=n(h,p,y,g,S[l+6],17,2821735955),g=n(g,h,p,y,S[l+7],22,4249261313),y=n(y,g,h,p,S[l+8],7,1770035416),p=n(p,y,g,h,S[l+9],12,2336552879),h=n(h,p,y,g,S[l+10],17,4294925233),g=n(g,h,p,y,S[l+11],22,2304563134),y=n(y,g,h,p,S[l+12],7,1804603682),p=n(p,y,g,h,S[l+13],12,4254626195),h=n(h,p,y,g,S[l+14],17,2792965006),g=n(g,h,p,y,S[l+15],22,1236535329),y=o(y,g,h,p,S[l+1],5,4129170786),p=o(p,y,g,h,S[l+6],9,3225465664),h=o(h,p,y,g,S[l+11],14,643717713),g=o(g,h,p,y,S[l+0],20,3921069994),y=o(y,g,h,p,S[l+5],5,3593408605),p=o(p,y,g,h,S[l+10],9,38016083),h=o(h,p,y,g,S[l+15],14,3634488961),g=o(g,h,p,y,S[l+4],20,3889429448),y=o(y,g,h,p,S[l+9],5,568446438),p=o(p,y,g,h,S[l+14],9,3275163606),h=o(h,p,y,g,S[l+3],14,4107603335),g=o(g,h,p,y,S[l+8],20,1163531501),y=o(y,g,h,p,S[l+13],5,2850285829),p=o(p,y,g,h,S[l+2],9,4243563512),h=o(h,p,y,g,S[l+7],14,1735328473),g=o(g,h,p,y,S[l+12],20,2368359562),y=s(y,g,h,p,S[l+5],4,4294588738),p=s(p,y,g,h,S[l+8],11,2272392833),h=s(h,p,y,g,S[l+11],16,1839030562),g=s(g,h,p,y,S[l+14],23,4259657740),y=s(y,g,h,p,S[l+1],4,2763975236),p=s(p,y,g,h,S[l+4],11,1272893353),h=s(h,p,y,g,S[l+7],16,4139469664),g=s(g,h,p,y,S[l+10],23,3200236656),y=s(y,g,h,p,S[l+13],4,681279174),p=s(p,y,g,h,S[l+0],11,3936430074),h=s(h,p,y,g,S[l+3],16,3572445317),g=s(g,h,p,y,S[l+6],23,76029189),y=s(y,g,h,p,S[l+9],4,3654602809),p=s(p,y,g,h,S[l+12],11,3873151461),h=s(h,p,y,g,S[l+15],16,530742520),g=s(g,h,p,y,S[l+2],23,3299628645),y=i(y,g,h,p,S[l+0],6,4096336452),p=i(p,y,g,h,S[l+7],10,1126891415),h=i(h,p,y,g,S[l+14],15,2878612391),g=i(g,h,p,y,S[l+5],21,4237533241),y=i(y,g,h,p,S[l+12],6,1700485571),p=i(p,y,g,h,S[l+3],10,2399980690),h=i(h,p,y,g,S[l+10],15,4293915773),g=i(g,h,p,y,S[l+1],21,2240044497),y=i(y,g,h,p,S[l+8],6,1873313359),p=i(p,y,g,h,S[l+15],10,4264355552),h=i(h,p,y,g,S[l+6],15,2734768916),g=i(g,h,p,y,S[l+13],21,1309151649),y=i(y,g,h,p,S[l+4],6,4149444226),p=i(p,y,g,h,S[l+11],10,3174756917),h=i(h,p,y,g,S[l+2],15,718787259),g=i(g,h,p,y,S[l+9],21,3951481745),y=t(y,u),g=t(g,c),h=t(h,f),p=t(p,d);return(a(y)+a(g)+a(h)+a(p)).toLowerCase()})(`reflex-${t}`):void 0;let s=r;o&&l(o).then((e=>{null!==e&&(i.value=e,i.listeners.forEach((r=>r(e))))})).catch((e=>{console.error("Error retrieving persisted value:",e)}));const i={value:s,initialValue:r,listeners:[],dropListeners:[],resetListeners:[],persisted:n,key:o},u=new Proxy(i,{set:(e,r,t)=>"value"===r&&(e.value=t,e.listeners.forEach((e=>e(t))),(async()=>{i.persisted&&i.key&&await a(i.key,i.value)})(),!0),deleteProperty:(e,r)=>"value"===r&&(e.dropListeners.forEach((r=>r(e.value))),delete e.value,i.persisted&&i.key&&a(i.key,null),!0)});return e.set(u,i),u},onReflexChange:(r,t)=>{t.forEach((t=>{const n=e.get(t);n&&n.listeners.push(r)}))},onReflexDrop:(r,t)=>{t.forEach((t=>{const n=e.get(t);n&&n.dropListeners.push(r)}))},onReflexReset:(r,t)=>{t.forEach((t=>{const n=e.get(t);n&&n.resetListeners.push(r)}))},reset:r=>{const t=e.get(r);t&&(t.value=t.initialValue,t.persisted&&t.key&&a(t.key,t.initialValue),t.listeners.forEach((e=>e(t.initialValue))),t.resetListeners.forEach((e=>e(t.initialValue))))}}},"object"==typeof module&&"object"==typeof module.exports?module.exports=e():"function"==typeof define&&define.amd?define([],e):globalThis.reflexor=e()}));
//# sourceMappingURL=reflexor.min.js.map
